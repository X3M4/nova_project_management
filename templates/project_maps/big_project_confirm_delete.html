<!-- filepath: /home/p102/django_projects/nova_workers_management/templates/project_maps/big_project_confirm_delete.html -->

{% extends 'base.html' %}
{% load static %}

{% block title %}Eliminar {{ big_project.name }}{% endblock %}

{% block extra_css %}
<style>
    .delete-container {
        max-width: 600px;
        margin: 0 auto;
        padding: 2rem;
    }
    
    .warning-card {
        background: linear-gradient(135deg, #fef3c7, #fed7aa);
        border: 2px solid #f59e0b;
        border-radius: 12px;
        padding: 2rem;
        margin-bottom: 2rem;
        position: relative;
        overflow: hidden;
    }
    
    .warning-card::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -50%;
        width: 100%;
        height: 200%;
        background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        transform: rotate(45deg);
    }
    
    .warning-header {
        display: flex;
        items: center;
        margin-bottom: 1.5rem;
        position: relative;
        z-index: 10;
    }
    
    .warning-icon {
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, #ef4444, #dc2626);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 1rem;
        flex-shrink: 0;
        font-size: 1.5rem;
        box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
    }
    
    .warning-title {
        font-size: 1.5rem;
        font-weight: bold;
        color: #92400e;
        margin: 0;
    }
    
    .warning-subtitle {
        color: #a16207;
        font-size: 0.9rem;
        margin: 0.5rem 0 0 0;
    }
    
    .project-info {
        background: white;
        border-radius: 8px;
        padding: 1.5rem;
        margin-bottom: 2rem;
        border: 1px solid #e2e8f0;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .info-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.75rem 0;
        border-bottom: 1px solid #f3f4f6;
    }
    
    .info-item:last-child {
        border-bottom: none;
    }
    
    .info-label {
        font-weight: 600;
        color: #4b5563;
        display: flex;
        align-items: center;
    }
    
    .info-label i {
        margin-right: 0.5rem;
        color: #8b5cf6;
    }
    
    .info-value {
        font-weight: 500;
        color: #1f2937;
        text-align: right;
    }
    
    .amount-display {
        font-size: 1.25rem;
        font-weight: bold;
        color: #059669;
    }
    
    .consequences-list {
        list-style: none;
        padding: 0;
        margin: 1rem 0;
    }
    
    .consequences-list li {
        background: #fef2f2;
        border: 1px solid #fecaca;
        border-radius: 6px;
        padding: 0.75rem;
        margin-bottom: 0.5rem;
        color: #991b1b;
        display: flex;
        align-items: center;
    }
    
    .consequences-list li i {
        margin-right: 0.5rem;
        color: #dc2626;
    }
    
    .action-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin-top: 2rem;
    }
    
    .btn {
        display: inline-flex;
        align-items: center;
        padding: 0.75rem 2rem;
        border-radius: 8px;
        font-weight: 500;
        text-decoration: none;
        cursor: pointer;
        border: none;
        transition: all 0.2s ease;
        font-size: 1rem;
    }
    
    .btn-cancel {
        background: white;
        color: #6b7280;
        border: 2px solid #d1d5db;
    }
    
    .btn-cancel:hover {
        background: #f9fafb;
        border-color: #9ca3af;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .btn-danger {
        background: linear-gradient(135deg, #ef4444, #dc2626);
        color: white;
        box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
    }
    
    .btn-danger:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
        background: linear-gradient(135deg, #dc2626, #b91c1c);
    }
    
    .confirmation-checkbox {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        padding: 1rem;
        margin: 1.5rem 0;
        text-align: center;
    }
    
    .checkbox-container {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-top: 1rem;
    }
    
    .checkbox-container input[type="checkbox"] {
        width: 20px;
        height: 20px;
        margin-right: 0.5rem;
        accent-color: #ef4444;
    }
    
    .checkbox-container label {
        color: #4b5563;
        font-weight: 500;
        cursor: pointer;
    }
    
    .breadcrumb {
        margin-bottom: 2rem;
        color: #6b7280;
        font-size: 0.9rem;
    }
    
    .breadcrumb a {
        color: #8b5cf6;
        text-decoration: none;
    }
    
    .breadcrumb a:hover {
        text-decoration: underline;
    }
    
    .breadcrumb i {
        margin: 0 0.5rem;
        color: #9ca3af;
    }
    
    @media (max-width: 768px) {
        .delete-container {
            padding: 1rem;
        }
        
        .action-buttons {
            flex-direction: column;
        }
        
        .warning-header {
            flex-direction: column;
            text-align: center;
        }
        
        .warning-icon {
            margin-right: 0;
            margin-bottom: 1rem;
        }
        
        .info-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 0.5rem;
        }
        
        .info-value {
            text-align: left;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="delete-container">
    <!-- Breadcrumb -->
    <div class="breadcrumb">
        <a href="{% url 'big_project_list' %}">
            <i class="fas fa-building"></i>Grandes Proyectos
        </a>
        <i class="fas fa-chevron-right"></i>
        <a href="{% url 'big_project_detail' big_project.pk %}">{{ big_project.name }}</a>
        <i class="fas fa-chevron-right"></i>
        <span>Eliminar</span>
    </div>

    <!-- Tarjeta de Advertencia -->
    <div class="warning-card">
        <div class="warning-header">
            <div class="warning-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div>
                <h1 class="warning-title">¡Advertencia de Eliminación!</h1>
                <p class="warning-subtitle">Esta acción no se puede deshacer</p>
            </div>
        </div>
        
        <div class="relative z-10">
            <p class="text-amber-800 font-medium mb-4">
                Estás a punto de eliminar permanentemente el gran proyecto 
                <strong>"{{ big_project.name }}"</strong>. 
                Una vez eliminado, no podrás recuperar esta información.
            </p>
            
            <div class="consequences-list">
                <li>
                    <i class="fas fa-database"></i>
                    Se perderán todos los datos del proyecto
                </li>
                <li>
                    <i class="fas fa-map-marker-alt"></i>
                    Se eliminará la ubicación y coordenadas
                </li>
                <li>
                    <i class="fas fa-euro-sign"></i>
                    Se perderá el registro de la inversión
                </li>
                <li>
                    <i class="fas fa-building"></i>
                    Se eliminará la información del desarrollador
                </li>
                <li>
                    <i class="fas fa-clock"></i>
                    Se perderán las fechas y el historial
                </li>
            </div>
        </div>
    </div>

    <!-- Información del Proyecto -->
    <div class="project-info">
        <h2 class="text-xl font-bold text-gray-900 mb-4 text-center">
            <i class="fas fa-info-circle mr-2 text-blue-500"></i>
            Información del Proyecto a Eliminar
        </h2>
        
        <div class="info-item">
            <div class="info-label">
                <i class="fas fa-tag"></i>Nombre del Proyecto
            </div>
            <div class="info-value">{{ big_project.name }}</div>
        </div>
        
        <div class="info-item">
            <div class="info-label">
                <i class="fas fa-euro-sign"></i>Monto de Inversión
            </div>
            <div class="info-value amount-display">€{{ big_project.amount|floatformat:0 }}</div>
        </div>
        
        {% if big_project.developer %}
        <div class="info-item">
            <div class="info-label">
                <i class="fas fa-building"></i>Desarrollador
            </div>
            <div class="info-value">{{ big_project.developer }}</div>
        </div>
        {% endif %}
        
        {% if big_project.start_date %}
        <div class="info-item">
            <div class="info-label">
                <i class="fas fa-calendar-alt"></i>Fecha de Inicio
            </div>
            <div class="info-value">{{ big_project.start_date|date:"d/m/Y" }}</div>
        </div>
        {% endif %}
        
        <div class="info-item">
            <div class="info-label">
                <i class="fas fa-map-marker-alt"></i>Ubicación
            </div>
            <div class="info-value">
                {% if big_project.city %}{{ big_project.city }}{% endif %}{% if big_project.province %}, {{ big_project.province }}{% endif %}{% if big_project.country %}, {{ big_project.country }}{% endif %}
            </div>
        </div>
        
        <div class="info-item">
            <div class="info-label">
                <i class="fas fa-clock"></i>Creado
            </div>
            <div class="info-value">{{ big_project.created_at|date:"d/m/Y H:i" }}</div>
        </div>
        
        {% if big_project.updated_at != big_project.created_at %}
        <div class="info-item">
            <div class="info-label">
                <i class="fas fa-edit"></i>Última Modificación
            </div>
            <div class="info-value">{{ big_project.updated_at|date:"d/m/Y H:i" }}</div>
        </div>
        {% endif %}
    </div>

    <!-- Confirmación -->
    <div class="confirmation-checkbox">
        <p class="text-gray-700 font-medium mb-2">
            <i class="fas fa-shield-alt mr-2 text-red-500"></i>
            Confirmación de Eliminación
        </p>
        <p class="text-sm text-gray-600 mb-3">
            Para proceder con la eliminación, debes confirmar que entiendes las consecuencias
        </p>
        
        <div class="checkbox-container">
            <input type="checkbox" id="confirm-delete" />
            <label for="confirm-delete">
                Entiendo que esta acción es irreversible y eliminará permanentemente el proyecto
            </label>
        </div>
    </div>

    <!-- Formulario de Eliminación -->
    <form method="post" id="delete-form">
        {% csrf_token %}
        
        <!-- Botones de Acción -->
        <div class="action-buttons">
            <a href="{% url 'big_project_detail' big_project.pk %}" class="btn btn-cancel">
                <i class="fas fa-arrow-left mr-2"></i>Cancelar
            </a>
            
            <button type="submit" class="btn btn-danger" id="delete-btn" disabled>
                <i class="fas fa-trash mr-2"></i>Eliminar Permanentemente
            </button>
        </div>
    </form>

    <!-- Información Adicional -->
    <div class="mt-8 text-center text-sm text-gray-500">
        <p>
            <i class="fas fa-lightbulb mr-2"></i>
            <strong>Consejo:</strong> Si no estás seguro, puedes volver y exportar los datos del proyecto antes de eliminarlo.
        </p>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const confirmCheckbox = document.getElementById('confirm-delete');
    const deleteBtn = document.getElementById('delete-btn');
    const deleteForm = document.getElementById('delete-form');
    
    // Habilitar/deshabilitar botón según checkbox
    confirmCheckbox.addEventListener('change', function() {
        deleteBtn.disabled = !this.checked;
        
        if (this.checked) {
            deleteBtn.style.opacity = '1';
            deleteBtn.style.cursor = 'pointer';
        } else {
            deleteBtn.style.opacity = '0.5';
            deleteBtn.style.cursor = 'not-allowed';
        }
    });
    
    
    
    // Prevenir salida accidental de la página
    window.addEventListener('beforeunload', function(e) {
        if (confirmCheckbox.checked) {
            const confirmationMessage = 'Tienes una eliminación pendiente. ¿Estás seguro de que quieres salir?';
            e.returnValue = confirmationMessage;
            return confirmationMessage;
        }
    });
    
    // Atajos de teclado
    document.addEventListener('keydown', function(e) {
        // ESC para cancelar
        if (e.key === 'Escape') {
            window.location.href = '{% url "big_project_detail" big_project.pk %}';
        }
        
        // Enter para confirmar (solo si el checkbox está marcado)
        if (e.key === 'Enter' && e.ctrlKey && confirmCheckbox.checked) {
            deleteForm.submit();
        }
    });
});
</script>
{% endblock %}